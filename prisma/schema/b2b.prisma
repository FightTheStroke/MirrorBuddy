// ============================================================================
// B2B & ENTERPRISE DOMAIN
// Managed schools, classrooms, and institutional licenses
// ============================================================================

model School {
  id          String   @id @default(cuid())
  name        String   @db.VarChar(255)
  address     String?  @db.VarChar(500)
  country     String   @db.VarChar(2)
  adminId     String   // Reference to the user with 'school_admin' role
  
  classrooms  Classroom[]
  licenses    License[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([adminId])
}

model Classroom {
  id        String   @id @default(cuid())
  schoolId  String
  name      String   @db.VarChar(100)
  grade     String?  @db.VarChar(50)
  
  school    School   @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  students  User[]   // Students assigned to this classroom
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([schoolId])
}

model License {
  id        String   @id @default(cuid())
  schoolId  String
  type      String   // 'Basic', 'Premium', 'Research'
  maxUsers  Int
  expiresAt DateTime
  status    String   @default("active") // 'active', 'expired', 'cancelled'
  
  school    School   @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([schoolId])
}

// Keep original ContactRequest for lead generation
model ContactRequest {
  id        String   @id @default(cuid())
  type      String   @db.VarChar(50) 
  name      String   @db.VarChar(255)
  email     String   @db.VarChar(254)
  data      Json     
  status    String   @default("pending") @db.VarChar(50)
  notes     String?  @db.VarChar(2000)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([type])
  @@index([status])
}