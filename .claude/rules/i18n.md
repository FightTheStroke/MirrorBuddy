# Internationalization Rules - MirrorBuddy i18n

## Framework & Setup

**Framework**: next-intl (App Router, server-first)
**Middleware**: `middleware.ts` handles locale detection and routing
**Message Files**: `messages/{locale}.json` (it, en, fr, de, es)
**Default Locale**: `it` (Italian)
**Locale Prefix**: Always included in URLs (e.g., `/it/chat`, `/en/home`)

## Namespaces (Message Structure)

Organize translations by domain in `messages/{locale}.json`:

| Namespace    | Use For                     | Examples                                |
| ------------ | --------------------------- | --------------------------------------- |
| `common`     | Global UI buttons           | save, delete, cancel, loading           |
| `navigation` | Menu & routes               | home, chat, dashboard, profile          |
| `auth`       | Login & signup              | login, emailRequired, passwordMinLength |
| `toasts`     | Success/error notifications | saved, error.occurred                   |
| `tools`      | Tool labels & descriptions  | pdf.label, mindmap.description          |
| `{feature}`  | Feature-specific content    | flashcards, quiz, homework              |

**Rules**: Keep `common` minimal, max 3 nesting levels (`namespace.group.key`)

## Client Components (useTranslations)

```tsx
"use client";
import { useTranslations } from "next-intl";

export function MyComponent() {
  const t = useTranslations("common");

  // Simple key
  <button>{t("save")}</button>;

  // With variables
  const t2 = useTranslations("auth");
  <span>{t2("passwordMinLength", { min: 8 })}</span>;

  // Nested keys
  const t3 = useTranslations("navigation");
  <span>{t3("breadcrumbs.home")}</span>;
}
```

## Server Components (getTranslations)

```tsx
import { getTranslations } from "next-intl/server";

export default async function MyPage() {
  const t = await getTranslations("common");
  const title = t("save");

  return <h1>{title}</h1>;
}
```

With explicit locale/namespace:

```tsx
const t = await getTranslations({ locale: "en", namespace: "tools" });
const label = t("pdf.label");
```

## Custom Hooks

**useTranslationsGlobal()** - Access any namespace:

```tsx
const t = useTranslationsGlobal();
t("common.save"); // Works
t("navigation.home"); // Works
```

**useLocaleContext()** - Get current locale + switch:

```tsx
const { locale, setLocale } = useLocaleContext();
```

## Adding New Translation Keys

1. Add same key to ALL language files (`messages/*.json`)
2. Use identical variable names across languages: `{min}`, `{count}`, etc.
3. Run `npm run typecheck` to verify all keys exist
4. Test in multiple languages before commit

## Toast Notifications

```tsx
import { useTranslations } from "next-intl";
import { createToastHelpers } from "@/lib/i18n/toast-utils";

const t = useTranslations("toasts");
const { success, error } = createToastHelpers(t);

success("pdf.downloaded");
error("export.failed");
```

## Full Documentation

Complete reference: `docs/i18n/` includes HOOKS.md, GUIDE.md, EXAMPLES.md, admin-guide.md
