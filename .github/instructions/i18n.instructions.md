---
description: 'Internationalization rules for 5-locale next-intl setup'
applyTo: 'messages/**/*.json,src/**/*translation*,src/**/*locale*,src/**/*i18n*'
---

# i18n Rules

## Locales: `it` (default) | `en` | `fr` | `de` | `es`

Framework: next-intl (App Router, server-first)

## CRITICAL: Wrapper Key Convention (ADR 0104)

ALL JSON message files MUST wrap content under a single key matching the filename:

```json
{ "namespace": { ...keys... } }
```

Missing wrapper keys cause namespace collisions via `Object.assign()`.

## Namespaces

common, auth, admin, chat, tools, settings, compliance, education,
navigation, errors, welcome, metadata

## Key Format

- camelCase ONLY (enforced by ESLint `no-kebab-case-i18n-keys`, ADR 0091)
- No hardcoded text in JSX (ESLint `no-hardcoded-italian`)

## Hooks

| Context          | Use                       |
| ---------------- | ------------------------- |
| Client component | `useTranslations('ns')`   |
| Server component | `getTranslations('ns')`   |
| Multiple NS      | `useTranslationsGlobal()` |
| Current locale   | `useLocaleContext()`      |

## Adding New Keys

1. Add Italian text first in `messages/it/{namespace}.json`
2. Run `npx tsx scripts/i18n-sync-namespaces.ts --add-missing`
3. Verify with `npm run i18n:check`

## Formal Address (ADR 0064)

Pre-1900 figures use Lei/Sie/Vous. Set in `FORMAL_PROFESSORS` at
`src/lib/greeting/templates/index.ts`.
